---
layout: post
title:  "一分钟读论文：《现代 Code Review 的系统文献综述》"
author: unbug
categories: [Engineering]
image: assets/images/screenshot-20230127-184311.jpg
tags: [featured, CodeReview, Agile]
---
Code Review 从结构化和严格的形式演变为灵活的、基于工具的异步过程，即` Modern Code Review (MCR)`。巴西南里奥格兰德州联邦大学 (UFRGS)和阿雷格里港信息学研究所合著的论文[《A Systematic Literature Review and Taxonomy of Modern Code Review》][paper1-url] 系统分析了 139 篇论文和来自行业、开源项目的问卷，详尽的记录了十多个细节性发现，能帮助我们了全面了解采用 MCR 的动机、挑战和好处，以及哪些影响因素导致哪些结果，并总结了 MCR 流程改进的建议。

## MCR 流程及改建建议
**典型的流程：**

![]({{ site.baseurl }}/assets/images/screenshot-20230127-184311.jpg)

- 第⼀阶段，审查计划，包括三个主要任务。在第⼀个（准备）中，作者准备更改的代码并附有详细信息的描述。选择可能或应该检查代码的合适审阅⼈。审阅者会收到邀请通知。
- 第⼆阶段，代码审阅，分析代码缺陷。每个审阅者单独执⾏代码检查、评估更改并将其与以前的版本进⾏⽐较。他们与作者互动，撰写反馈意⻅，注释代码⽚段，或促进讨论以澄清问题，做出决定（Review Decision），可以是接受、拒绝和返⼯。最后根据审阅者的反馈更新代码后进⾏新的审阅周期。
- 这些任务⾄少由两个⻆⾊执⾏，即作者和审阅者。作者是更改源代码并为其创建审阅请求的开发⼈员，⽽审阅者（通常也是开发⼈员）负责审查代码并提供反馈。


**改进建议：**

![]({{ site.baseurl }}/assets/images/screenshot-20230129-155136.jpg)

- Review 计划： 计划阶段相关的⽀持，即在审核⼈员审核代码之前，提供的⽀持类型：`变更⽂档、推荐人、Review 优先级`。
- Code Review ：Review 阶段相关的⽀持，提供的⽀持类型：`代码检查、Review 反馈和 Review 决策`。
- 过程管理：过程相关的支持，提供的⽀持类型：`方法论指南、Review 回顾、工具支持`。

## 论文研究发现
- 多种因素影响 MCR 的采用。 在行业中，它的采用受到文化、产品、工具、开发过程和团队的影响。 在开源项目中，影响更多的是人文和社会方面，尤其是黑客伦理。
- 在开源项目中，平均有一个或两个审阅请求的审阅者。 总的来说，小的代码改动和长篇大论的审查请求描述更容易吸引审查者。 开发人员更愿意邀请`有经验的审阅者`。
- 审阅者表示困惑，通常是由于缺少基本原理、对非功能性需求的讨论以及对代码不熟悉。在开源项目中，每个请求平均有两到三个审阅意见。 `新人往往会受到更多关注`。
- 当涉及熟悉代码的`经验丰富的作者、经验丰富且积极且高度一致的审阅者时，审阅请求的完成时间会更短`。 
- 被接受的代码更改通常由经验丰富的开发人员编写，并包含带有积极情绪的审查反馈。 考虑到审查反馈分析，`放弃代码更改的主要原因是重复和缺乏反馈`。
- `审查代码更改后，产品质量往往会提高`。 更多地参与代码审查、审查活动的更多经验以及审查者更熟悉项目也是降低发布后缺陷可能性的因素。
- 编程经验可能会影响审查人员在代码检查期间的注意力和脑力劳动。 在审查代码时，与语言处理和数学相关的特定大脑区域会增加活动，有经验的开发人员倾向于将编程语言视为自然语言。
- `MCR 和结对编程在成本方面是可以互换的，除非在测试驱动开发中采用后者——在这种情况下，MCR 的成本更低`。 
- 单元测试比 MCR 发现更多的故障，但后者在检测和隔离缺陷的潜在来源方面需要更少的时间。
- 静态分析工具提出的警告很少在代码审查期间被删除。 依赖于持续集成的上下文、频繁构建的项目和状态为 passed 的自动构建，与审查者的参与度增加有关。


[paper1-url]: https://arxiv.org/pdf/2103.08777.pdf 